<!DOCTYPE html>
<html>
<head>
    <title>Scan Results</title>

<style>
    body {
        font-family: Arial;
        margin: 40px;
        background: var(--bg);
        color: var(--text);
        transition: 0.3s;
    }

    :root {
        --bg: white;
        --text: black;
        --table-bg: #f3f3f3;
    }

    .dark {
        --bg: #121212;
        --text: #ffffff;
        --table-bg: #1e1e1e;
    }

    table {
        background: var(--table-bg);
        border-collapse: collapse;
        width: 100%;
    }

    th, td {
        padding: 8px;
        border: 1px solid gray;
    }

    .toggle-btn {
        position: fixed;
        right: 20px;
        top: 20px;
        padding: 8px 16px;
        background: #333;
        color: white;
        cursor: pointer;
        border: none;
    }
</style>

<script>
function toggleDarkMode() {
    const body = document.body;
    body.classList.toggle('dark');
    localStorage.setItem("darkmode", body.classList.contains("dark"));
}
window.onload = () => {
    if (localStorage.getItem("darkmode") === "true") {
        document.body.classList.add("dark");
    }
}
</script>

</head>
<body>

<button class="toggle-btn" onclick="toggleDarkMode()">ðŸŒ“ Dark Mode</button>

<h2>ðŸ“„ Scan Results</h2>

<form method="POST" action="/api/export_pdf" target="_blank">
    <input type="hidden" name="url" value="{{ url }}">
    <input type="hidden" name="data" value="{{ results | tojson | safe }}">
    <button type="submit" style="padding: 8px 16px;">â¬‡ Download PDF</button>
</form>

<br><br>

{% for r in results %}
<h3>Parameter: {{ r.param }}</h3>

<table>
<tr>
    <th>Payload</th>
    <th>Status</th>
    <th>Time</th>
    <th>Snippet</th>
</tr>

{% for t in r.tests %}
<tr>
    <td>{{ t.payload }}</td>
    <td>{{ t.status if "status" in t else "ERR" }}</td>
    <td>{{ t.response_time if "response_time" in t else "-" }}</td>
    <td><pre>{{ t.body_snippet }}</pre></td>
</tr>
{% endfor %}
</table>
<br>
{% endfor %}

<br>
<a href="/">â¬… Back</a>

</body>
</html>
